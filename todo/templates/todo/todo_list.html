{% extends 'firstapp/index.html' %}

{% block contents %}
<html>
<head>
    <style>
        input[type=checkbox]:checked + label {
            text-decoration: line-through;
        }
    </style>
</head>
<body>
    <div class="">
        <form action="" method="POST">
            {% csrf_token %}
            <div class="">
                {{ Items }}
                <span>
                <button type="submit" name="add_todo">메모하기!</button>
                </span>
            </div>
        </form>
        {% for show in todo_list %}
        <div class="">
            <form id="delete-form-{{ show.pk }}" action="/todo/item/" method="POST">
                {% csrf_token %}
                <input type="hidden" name="id" value="{{ show.pk }}">
                <input type="checkbox" id="{{ show.pk }}" name="checkbox">
                <label for="{{ show.pk }}">{{ show.todo_content }}</label>
                <span>
                    <button type="submit" name="delete_todo">할일 완료</button>
                </span>
            </form>
        {% endfor %}
        {% if error %}
        {{ error }}
        {% endif %}
        </div>
    </div>
    <script>
        const deleteForms = document.querySelectorAll('[id^="delete-form-"]');

        deleteForms.forEach((form) => {
            form.addEventListener('submit', (event) => {
                const checkbox = form.elements.checkbox;
                if (!checkbox.checked) {
                    event.preventDefault();
                    alert('체크박스를 선택해주세요.');
                }
            });
        });
    </script>
</body>
</html>
{% endblock contents %}